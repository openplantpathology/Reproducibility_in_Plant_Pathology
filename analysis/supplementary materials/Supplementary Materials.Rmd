---
title: "Supplementary Materials for Openness and Computational Reproducibility in Plant Pathology: Where do we Stand and a Way Forward"
author:
  - Adam H. Sparks:
      email: Adam.Sparks@dpird.wa.gov.au
      institute: DPIRD, USQ
      correspondence: true
  - Emerson M. Del Ponte:
      institute: UFV
  - Kaique S. Alves:
      institute: UFV
  - Zachary S. L. Foster:
      institute: OSU
  - Niklaus J. Grünwald:
      institute: ARS
institute:
  - DPIRD: Department of Primary Industries and Regional Development, Farming Systems Innovation, Perth WA 6000, Australia
  - USQ: University of Southern Queensland, Centre for Crop Health, Toowoomba Qld 4350, Australia
  - UFV: Departmento de Fitopatologia, Universidade Federal de Viçosa, Brazil
  - OSU: Department of Botany and Plant Pathology, Oregon State University, Corvallis OR 97331, USA
  - ARS: Horticultural Crops Research Unit, USDA Agricultural Research Service, Corvallis OR 97330, USA
output: 
  officedown::rdocx_document:
     pandoc_args:
       - '--lua-filter=pagebreak.lua'
     fig_caption: yes
     number_sections: FALSE
     reference_docx: "../templates/phytopath_template.docx"
---

```{r, setup, echo = FALSE, message=FALSE, warning=FALSE}

library("Reproducibility.in.Plant.Pathology")
packages <- c(
  "tidyverse",
  "bayesplot",
  "bayestestR",
  "brms",
  "extrafont",
  "flextable",
  "ggpubr",
  "here",
  "knitr",
  "officer",
  "pander",
  "posterior",
  "report",
  "tools"
)

install.packages(setdiff(packages,
                         rownames(installed.packages())),
                 repos = "http://cran.us.r-project.org",
                 dependencies = TRUE)

invisible(lapply(packages,
                 library,
                 character.only = TRUE))

options(mc.cores = parallel::detectCores())
theme_set(theme_classic())

rrpp <- import_notes()
ir <- import_interrater_scores()

load(
  system.file(
    "extdata",
    "m_f1.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_f1_report.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_f2.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_f2_report.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)

load(
  system.file(
    "extdata",
    "m_g1.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_g1_report.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_g2.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_g2_report.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)

load(
  system.file(
    "extdata",
    "m_h1.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_h1_report.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_h2.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
load(
  system.file(
    "extdata",
    "m_h2_report.Rda",
    package = "Reproducibility.in.Plant.Pathology",
    mustWork = TRUE
  )
)
```

```{r fonts, include=FALSE, message=FALSE, eval=FALSE}
# Note 1: This chunk only needs to be run once on a computer to import fonts for
# use in R. This chunk makes .ttf fonts available to R for use and embedding in
# .eps figure outputs.
#
# Note 2: GhostScript needs to be installed at the system level for the PS files
# to be generated.  MacOS users can use `brew install ghostscript`.  Windows
# users should download and install. Linux users can use their package manager.
#
# Note 3: You may need to tell R where to find GhostScript's 'gs' executable.
# Set `R_GSCMD="/opt/homebrew/bin/gs"` in .Renviron for MacOS users using
# homebrew to install on a Mac M1.
# 
# Windows users can follow these directions:
# 1.	Go to the GhostScript website
#     <https://www.ghostscript.com/download/gsdnld.html>.
# 2.	Download the windows installer suitable for your machine
# 3.	Run the installer file which you downloaded and follow the prompts
# 4.	After running the installer click the windows "Start" button and type
#     "Edit environment variables for your account" and open
# 5.	In the tab 'Advanced' click the button at the bottom
#     'Environment Variables...'
# 6.	Under 'System variables' find the variable 'Path', select 'Path' and click
#     the 'Edit' button
# 7. 	Select a new line and copy the Ghostscript 'bin' folder location into the
#     field.
## 7.1	If you installed Ghostscript to the default folder location; then the
#     folder location will likely be "C:\Program Files\gs\gs9.52\bin", the
#     version number (9.52) may differ.
# 8.	Save and exit the environmental variables window
#
# This chunk is then run only if knitting on new computer that the files have
# not been generated

font_import()
```

# Supplementary Materials

## Journal Publication Model Reports

### Computational Methods

```{r journal-code-test, echo=FALSE, message=FALSE, warning=FALSE}
p <- plot(equivalence_test(m_f1))

ggsave(
  filename = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_1.eps"
  ),
  plot = p,
  width = 6,
  height = 6,
  units = "in",
  device = cairo_ps
)
embed_fonts(
  file = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_1.eps"
  ),
  outfile = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_1.eps"
  ),
  options = "-dEPSCrop"
)
include_graphics(path = here(
  "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_1.eps"
))
```

```{r journal-code, echo=FALSE}
m_f1_report %>% 
  pander()
```

### Data

```{r journal-data-test, echo=FALSE, message=FALSE, warning=FALSE}
p <- plot(equivalence_test(m_f2))

ggsave(
  filename = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_2.eps"
  ),
  plot = p,
  width = 6,
  height = 6,
  units = "in",
  device = cairo_ps
)
embed_fonts(
  file = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_2.eps"
  ),
  outfile = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_2.eps"
  ),
  options = "-dEPSCrop"
)
include_graphics(path = here(
  "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_2.eps"
))
```

```{r journal-data, echo=FALSE}
m_f2_report %>% 
  pander()
```

\newpage

## Year

### Computational Methods

```{r year-code-test, echo=FALSE, message=FALSE, warning=FALSE}
p <- plot(equivalence_test(m_g1))

ggsave(
  filename = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_3.eps"
  ),
  plot = p,
  width = 6,
  height = 6,
  units = "in",
  device = cairo_ps
)
embed_fonts(
  file = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_3.eps"
  ),
  outfile = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_3.eps"
  ),
  options = "-dEPSCrop"
)
include_graphics(path = here(
  "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_3.eps"
))
```

```{r year-code, echo=FALSE}
m_g1_report %>% 
  pander()
```

### Data

```{r year-data-test, echo=FALSE, message=FALSE, warning=FALSE}
p <- plot(equivalence_test(m_g2))

ggsave(
  filename = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_4.eps"
  ),
  plot = p,
  width = 6,
  height = 6,
  units = "in",
  device = cairo_ps
)
embed_fonts(
  file = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_4.eps"
  ),
  outfile = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_4.eps"
  ),
  options = "-dEPSCrop"
)
include_graphics(path = here(
  "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_4.eps"
))
```

```{r year-data, echo=FALSE}
m_g2_report %>% 
  pander()
```

\newpage

## Five-year Impact Factor

### Computational Methods

```{r if5yr-code-test, echo=FALSE, message=FALSE, warning=FALSE}
p <- plot(equivalence_test(m_h1))

ggsave(
  filename = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_5.eps"
  ),
  plot = p,
  width = 6,
  height = 6,
  units = "in",
  device = cairo_ps
)
embed_fonts(
  file = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_5.eps"
  ),
  outfile = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_5.eps"
  ),
  options = "-dEPSCrop"
)
include_graphics(path = here(
  "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_5.eps"
))
```

```{r if5yr-code, echo=FALSE}
m_h1_report %>% 
  pander()
```

### Data

```{r if5yr-data-test, echo=FALSE, message=FALSE, warning=FALSE}
p <- plot(equivalence_test(m_h2))

ggsave(
  filename = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_6.eps"
  ),
  plot = p,
  width = 6,
  height = 6,
  units = "in",
  device = cairo_ps
)
embed_fonts(
  file = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_6.eps"
  ),
  outfile = here(
    "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_6.eps"
  ),
  options = "-dEPSCrop"
)
include_graphics(path = here(
  "analysis/supplementary figures/Sparks_et_al_Supplementary_Figure_6.eps"
))
```

```{r if5yr-data, echo=FALSE}
m_h2_report %>% 
  pander()
```

## Tables

\newpage

```{r effects-analysis-code, echo=FALSE, message=FALSE, warning=FALSE}
as_tibble(m_f1_report) %>%
  filter(!grepl("Intercept", Parameter)) %>%
  filter(!grepl("R2", Parameter)) %>%
  filter(!is.na(Parameter)) %>% 
  rename("ROPE %" = "ROPE_Percentage",
         "CI\nLow" = "CI_low",
         "CI\nHigh" = "CI_high") %>%
  flextable() %>%
  fontsize(size = 8, part = "all") %>% 
  colformat_double(digits = 2) %>% 
    set_formatter(
    `ROPE %` = function(x)
      ifelse((!is.na(x)), sprintf("%1.f%%", x * 100), x)
  ) %>%
  autofit() %>%
  set_caption("")
```

\newpage

```{r effects-analysis-data, echo=FALSE, message=FALSE, warning=FALSE}
as_tibble(m_f2_report) %>%
  filter(!grepl("Intercept", Parameter)) %>%
  filter(!grepl("R2", Parameter)) %>%
  filter(!is.na(Parameter)) %>% 
  rename("ROPE %" = "ROPE_Percentage",
         "CI\nLow" = "CI_low",
         "CI\nHigh" = "CI_high") %>%
  flextable() %>%
  fontsize(size = 8, part = "all") %>% 
  colformat_double(digits = 2) %>% 
    set_formatter(
    `ROPE %` = function(x)
      ifelse((!is.na(x)), sprintf("%1.f%%", x * 100), x)
  ) %>%
  autofit() %>%
  set_caption("")
```

\newpage

```{r year-analysis-code, echo=FALSE, message=FALSE, warning=FALSE}
as_tibble(m_g1_report) %>%
  filter(!grepl("Intercept", Parameter)) %>%
  filter(!grepl("R2", Parameter)) %>%
  filter(!is.na(Parameter)) %>% 
  rename("ROPE %" = "ROPE_Percentage",
         "CI\nLow" = "CI_low",
         "CI\nHigh" = "CI_high") %>%
  flextable() %>%
  fontsize(size = 8, part = "all") %>% 
  colformat_double(digits = 2) %>% 
    set_formatter(
    `ROPE %` = function(x)
      ifelse((!is.na(x)), sprintf("%1.f%%", x * 100), x)
  ) %>%
  autofit() %>%
  set_caption("")
```

\newpage

```{r year-analysis-data, echo=FALSE, message=FALSE, warning=FALSE}
as_tibble(m_g2_report) %>%
  filter(!grepl("Intercept", Parameter)) %>%
  filter(!grepl("R2", Parameter)) %>%
  filter(!is.na(Parameter)) %>% 
  rename("ROPE %" = "ROPE_Percentage",
         "CI\nLow" = "CI_low",
         "CI\nHigh" = "CI_high") %>%
  flextable() %>%
  fontsize(size = 8, part = "all") %>% 
  colformat_double(digits = 2) %>% 
    set_formatter(
    `ROPE %` = function(x)
      ifelse((!is.na(x)), sprintf("%1.f%%", x * 100), x)
  ) %>%
  autofit() %>%
  set_caption("")
```

\newpage

```{r if-5yr-analysis-code, echo=FALSE, message=FALSE, warning=FALSE}
as_tibble(m_h1_report) %>%
  filter(!grepl("Intercept", Parameter)) %>%
  filter(!grepl("R2", Parameter)) %>%
  filter(!is.na(Parameter)) %>% 
  rename("ROPE %" = "ROPE_Percentage",
         "CI\nLow" = "CI_low",
         "CI\nHigh" = "CI_high") %>%
  flextable() %>%
  fontsize(size = 8, part = "all") %>% 
  colformat_double(digits = 2) %>% 
    set_formatter(
    `ROPE %` = function(x)
      ifelse((!is.na(x)), sprintf("%1.f%%", x * 100), x)
  ) %>%
  autofit() %>%
  set_caption("")
```

\newpage

```{r if-5yr-analysis-data, echo=FALSE, message=FALSE, warning=FALSE}
as_tibble(m_h2_report) %>%
  filter(!grepl("Intercept", Parameter)) %>%
  filter(!grepl("R2", Parameter)) %>%
  filter(!is.na(Parameter)) %>% 
  rename("ROPE %" = "ROPE_Percentage",
         "CI\nLow" = "CI_low",
         "CI\nHigh" = "CI_high") %>%
  flextable() %>%
  fontsize(size = 8, part = "all") %>% 
  colformat_double(digits = 2) %>% 
    set_formatter(
    `ROPE %` = function(x)
      ifelse((!is.na(x)), sprintf("%1.f%%", x * 100), x)
  ) %>%
  autofit() %>%
  set_caption("")
```
