---
title: "Analysis of Software Availability Effect"
author: "Adam H. Sparks"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Analysis of Software Availability Effect}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  %\VignetteDepends{brms}
  %\VignetteDepends{bayestestR}
  %\VignetteDepends{bayesplot}
  %\VignetteDepends{ggplot2}
  %\VignetteDepends{here}
  %\VignetteDepends{pander}
  %\VignetteDepends{tidyr}
  %\VignetteDepends{sessioninfo}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
knitr::opts_chunk$set(fig.width = 6.4, fig.height = 6.4)
```

This vignette documents the analysis of the data gathered from surveying 21 journals and 450 articles in the field of plant pathology for their openness and reproducibility and the effect that the software used instructions had on the availaibility of code and data.

# Set-up Workspace

Load libraries used and setting the *ggplot2* theme for the document.

```{r load-libraries, message=FALSE}
library("brms")
library("bayestestR")
library("bayesplot")
library("ggplot2")
library("here")
library("pander")
library("tidyr")
library("Reproducibility.in.Plant.Pathology")

options(mc.cores = parallel::detectCores())
theme_set(theme_classic())
```

## Software Availability (Openness of Software Used) Models

### Computational Methods Availability

Test for any relationship between the openness of the software used had on the availability of code.

```{r code}
priors <- prior_string("normal(0, 1.5)")
rrpp <- import_notes()
rrpp <- drop_na(rrpp, comp_mthds_avail)

m_k1 <-
  brm(
    formula = comp_mthds_avail ~ software_avail +
      (1 | year) +
      (1 | assignee) +
      (1 | abbreviation),
    data = rrpp,
    seed = 27,
    prior = priors,
    family = cumulative(link = "logit"),
    control = list(adapt_delta = 0.99),
    iter = 6000,
    chains = 4
  )

summary(m_k1)

plot(m_k1)

pp_check(m_k1)

plot(pd(m_k1))

pander(equivalence_test(m_k1))
```

### Data Availability

Test for any relationship between the openness of the software used had on the availability of data.

```{r data}
rrpp <- import_notes()
rrpp <- drop_na(rrpp, data_avail)

m_k2 <-
  brm(
    formula = data_avail ~ software_avail +
      (1 | year) +
      (1 | assignee) +
      (1 | abbreviation),
    data = rrpp,
    seed = 27,
    prior = priors,
    family = cumulative(link = "logit"),
    control = list(adapt_delta = 0.99),
    iter = 6000,
    chains = 4
  )

summary(m_k2)

plot(m_k2)

pp_check(m_k2)

plot(pd(m_k2))

pander(equivalence_test(m_k2))
```

## Save Model Objects

Save the model objects for figures in the paper.

```{r save}
save(m_k1, file = here("inst/extdata/m_k1.Rda"))
save(m_k2, file = here("inst/extdata/m_k2.Rda"))
```

# Colophon

```{r sessioninfo}
sessioninfo::session_info()
```
