---
title: "Analysis of Five Year Impact Factor Effect"
author: "Adam H. Sparks"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Analysis of Five Year Impact Factor Effect}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  %\VignetteDepends{brms}
  %\VignetteDepends{bayestestR}
  %\VignetteDepends{bayesplot}
  %\VignetteDepends{ggplot2}
  %\VignetteDepends{here}
  %\VignetteDepends{tidyr}
  %\VignetteDepends{sessioninfo}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
knitr::opts_chunk$set(fig.width = 6.4, fig.height = 6.4)
```

This vignette documents the analysis of the data gathered from surveying 21 journals and 450 articles in the field of plant pathology for their openness and reproducibility and the effect that the journal's 5-year impact factor had on that score.

# Set-up Workspace

Load libraries used and setting the *ggplot2* theme for the document.

```{r load-libraries, message=FALSE}
library("brms")
library("bayestestR")
library("bayesplot")
library("ggplot2")
library("here")
library("tidyr")
library("Reproducibility.in.Plant.Pathology")

options(mc.cores = parallel::detectCores())
theme_set(theme_classic())
```

### Priors

The priors are fairly uninformative.

```{r priors}
priors <- prior_string("normal(0, 1.5)")
```

## Five Year Impact Factor Model

### Computational Methods Availability

Test the effect that journal's five year impact factor had on the reproducibility score.

```{r code}
rrpp <- import_notes()
rrpp <- drop_na(rrpp, comp_mthds_avail)

m_g1 <-
  brm(
    formula = comp_mthds_avail ~ IF_5year +
      (1 | year) +
      (1 | assignee) +
      (1 | abbreviation),
    data = rrpp,
    seed = 27,
    prior = priors,
    family = cumulative(link = "logit"),
    control = list(adapt_delta = 0.99),
    iter = 6000,
    chains = 4
  )

summary(m_g1)

plot(m_g1)

pp_check(m_g1)

plot(pd(m_g1))

equivalence_test(m_g1)
```

### Data Availability

Test for any effects of the five year impact factor on the data's availability.

```{r data}
rrpp <- import_notes()
rrpp <- drop_na(rrpp, data_avail)

m_g2 <-
  brm(
    formula = data_avail ~ IF_5year +
      (1 | year) +
      (1 | assignee) +
      (1 | abbreviation),
    data = rrpp,
    seed = 27,
    prior = priors,
    family = cumulative(link = "logit"),
    control = list(adapt_delta = 0.99),
    iter = 6000,
    chains = 4
  )

summary(m_g2)

plot(m_g2)

pp_check(m_g2)

plot(pd(m_g2))

equivalence_test(m_g2)
```

### Openness

Test for any effects of the five year impact factor on the `software_avail` (openness) of the software used.

```{r openness}
rrpp <- import_notes()
rrpp <- drop_na(rrpp, software_avail)

m_g3 <-
  brm(
    formula = software_avail ~ IF_5year +
      (1 | year) +
      (1 | assignee),
    data = rrpp,
    seed = 27,
    prior = priors,
    family = cumulative(link = "logit"),
    control = list(adapt_delta = 0.99),
    iter = 6000,
    chains = 4
  )

summary(m_g3)

plot(m_g3)

pp_check(m_g3)

plot(pd(m_g3))

equivalence_test(m_g3)
```

## Save Model Objects

Save the model objects for figures in the paper.

```{r save}
save(m_g1, file = here("inst/extdata/m_g1.Rda"))
save(m_g2, file = here("inst/extdata/m_g2.Rda"))
save(m_g3, file = here("inst/extdata/m_g3.Rda"))
```

# Colophon

```{r sessioninfo}
sessioninfo::session_info()
```
