---
title: "Analysis of Article Class Effect"
author: "Adam H. Sparks"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Analysis of Article Class Effect}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  %\VignetteDepends{brms}
  %\VignetteDepends{bayestestR}
  %\VignetteDepends{bayesplot}
  %\VignetteDepends{ggplot2}
  %\VignetteDepends{here}
  %\VignetteDepends{pander}
  %\VignetteDepends{sessioninfo}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
knitr::opts_chunk$set(fig.width = 6.4, fig.height = 6.4)
```

This vignette documents the analysis of the data gathered from surveying 21 journals and 450 articles in the field of plant pathology for their openness and reproducibility and the effect that the article's classification, *i.e.*, applied or fundamental, had on that score.

# Set-up Workspace

Load libraries used and setting the *ggplot2* theme for the document.

```{r load-libraries, message=FALSE}
library("brms")
library("bayestestR")
library("bayesplot")
library("ggplot2")
library("here")
library("pander")
library("Reproducibility.in.Plant.Pathology")

options(mc.cores = parallel::detectCores())
theme_set(theme_classic())
```

## Import Data

```{r import-notes}
rrpp <- import_notes()
```

## Notes

All models are using the same priors.

Because of the amount of zero values in the `reproducibility_score` a `hurdle_gamma()` family is used for all models as well.

## Article Class Model

### Priors

The priors are fairly flat.

```{r priors}
priors <- prior_string("normal(0, 10)")
```

Test the effect that the article's class, `applied` or `fundamental` had on the reproducibility score.
Here, `art_class` is a fixed effect, `year`, `assignee` and `journal` are assigned as random effects.

```{r article-class}
m_g <-
  brm(
    formula = reproducibility_score ~  art_class + (1 | year) + (1 | assignee) +
      (1 | journal),
    data = rrpp,
    seed = 25,
    prior = priors,
    family = hurdle_gamma(),
    control = list(adapt_delta = 0.99999,
                   stepsize = 0.001,
                   max_treedepth = 20),
    iter = 3000,
    chains = 4
  )

summary(m_g)

plot(m_g)

pp_check(m_g)

plot(pd(m_g))

pander(equivalence_test(m_g))

# save the model for figures in the paper
save(m_g, file = here("inst/extdata/m_g.Rda"))
```

# Colophon

```{r sessioninfo}
sessioninfo::session_info()
```
